{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/product.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nexport let CheckoutComponent = /*#__PURE__*/(() => {\n  class CheckoutComponent {\n    constructor(product, router) {\n      this.product = product;\n      this.router = router;\n    }\n    ngOnInit() {\n      // Load cart details to calculate the total price\n      this.product.currentCart().subscribe(result => {\n        let price = 0;\n        this.cartData = result;\n        result.forEach(item => {\n          if (item.quantity) {\n            price = price + +item.price * +item.quantity;\n          }\n        });\n        // Calculate the total price including tax and delivery\n        this.totalPrice = price + price / 10 + 100 - price / 10;\n        console.warn(this.totalPrice);\n      });\n    }\n    // Function to place an order\n    orderNow(data) {\n      let user = localStorage.getItem('user');\n      let userId = user && JSON.parse(user).id;\n      if (this.totalPrice) {\n        // Create order data based on user input\n        let orderData = {\n          ...data,\n          totalPrice: this.totalPrice,\n          userId,\n          id: undefined\n        };\n        // Delete items from the cart after placing the order\n        this.cartData?.forEach(item => {\n          setTimeout(() => {\n            item.id && this.product.deleteCartItems(item.id);\n          }, 700);\n        });\n        // Make an API call to place the order\n        this.product.orderNow(orderData).subscribe(result => {\n          if (result) {\n            // Display a success message\n            this.orderMsg = \"Order has been placed\";\n            setTimeout(() => {\n              this.orderMsg = undefined;\n              // Navigate to my-orders page after a successful order\n              this.router.navigate(['/my-orders']);\n            }, 4000);\n          }\n        });\n      }\n    }\n    static #_ = this.ɵfac = function CheckoutComponent_Factory(t) {\n      return new (t || CheckoutComponent)(i0.ɵɵdirectiveInject(i1.ProductService), i0.ɵɵdirectiveInject(i2.Router));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CheckoutComponent,\n      selectors: [[\"app-checkout\"]],\n      decls: 41,\n      vars: 2,\n      consts: [[1, \"checkout\", \"mt-4\"], [1, \"heading-section\"], [1, \"heading-h4\"], [1, \"heading\"], [1, \"heading-p\"], [1, \"row\"], [1, \"col-sm-7\"], [1, \"message-p\"], [1, \"common-form\", 3, \"ngSubmit\"], [\"orderData\", \"ngForm\"], [1, \"mb-3\"], [\"type\", \"email\", \"name\", \"email\", \"placeholder\", \"Enter User Email\", \"ngModel\", \"\", \"required\", \"\", 1, \"form-control\"], [\"type\", \"text\", \"name\", \"address\", \"placeholder\", \"Enter User Address\", \"ngModel\", \"\", \"required\", \"\", 1, \"form-control\"], [\"type\", \"text\", \"name\", \"contact\", \"placeholder\", \"Enter Contact Details\", \"ngModel\", \"\", \"required\", \"\", 1, \"form-control\"], [1, \"btn\", \"btn-primary\", \"btn-block\"], [1, \"col-sm-4\"], [1, \"table\", \"table-bordered\"], [\"scope\", \"row\", 1, \"h4\"], [1, \"h4\", \"text-primary\"], [\"scope\", \"row\", 1, \"h5\"], [1, \"h5\"]],\n      template: function CheckoutComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h4\", 2);\n          i0.ɵɵtext(3, \"Complete Your Purchase\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"div\", 3);\n          i0.ɵɵtext(5, \"Checkout\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"div\", 4);\n          i0.ɵɵtext(7, \" It's time to finalize your order. Please provide your shipping address and payment information to complete your purchase. \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(8, \"br\");\n          i0.ɵɵelementStart(9, \"div\", 5)(10, \"div\", 6)(11, \"h3\");\n          i0.ɵɵtext(12, \"Add Shipping Address\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"p\", 7);\n          i0.ɵɵtext(14);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"form\", 8, 9);\n          i0.ɵɵlistener(\"ngSubmit\", function CheckoutComponent_Template_form_ngSubmit_15_listener() {\n            i0.ɵɵrestoreView(_r1);\n            const _r0 = i0.ɵɵreference(16);\n            return i0.ɵɵresetView(ctx.orderNow(_r0.value));\n          });\n          i0.ɵɵelementStart(17, \"div\", 10);\n          i0.ɵɵelement(18, \"input\", 11);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"div\", 10);\n          i0.ɵɵelement(20, \"input\", 12);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"div\", 10);\n          i0.ɵɵelement(22, \"input\", 13);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"button\", 14);\n          i0.ɵɵtext(24, \"Order Now\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(25, \"div\", 15)(26, \"table\", 16)(27, \"tbody\")(28, \"tr\")(29, \"th\", 17);\n          i0.ɵɵtext(30, \"Total Amount :\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"td\")(32, \"p\", 18);\n          i0.ɵɵtext(33);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(34, \"tr\")(35, \"th\", 19);\n          i0.ɵɵtext(36, \"Payment Method :\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"td\")(38, \"p\", 20)(39, \"b\");\n          i0.ɵɵtext(40, \"Pay on Delivery\");\n          i0.ɵɵelementEnd()()()()()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(14);\n          i0.ɵɵtextInterpolate(ctx.orderMsg);\n          i0.ɵɵadvance(19);\n          i0.ɵɵtextInterpolate1(\"\", ctx.totalPrice, \" \\u00A0 INR\");\n        }\n      },\n      dependencies: [i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm],\n      styles: [\".checkout[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:50px}.checkout[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{text-align:center;margin-top:15px;color:#f5f5f5}.checkout[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#ffba00}.col-sm-4[_ngcontent-%COMP%]{margin-top:30px}.heading-section[_ngcontent-%COMP%]{justify-content:center;align-items:center;text-align:center}.heading-h4[_ngcontent-%COMP%]{color:#fff;text-transform:uppercase;font-size:14px}.heading[_ngcontent-%COMP%]{font-size:35px;font-weight:700;color:#ffba00}.heading-p[_ngcontent-%COMP%]{color:#a0a0a0;margin:.2rem 0 .2rem 1.5rem;font-size:1.1rem}\"]\n    });\n  }\n  return CheckoutComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}